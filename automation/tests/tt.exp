#!/usr/bin/expect -f

exp_internal 1
set HOST [lindex $argv 0]
set USERNAME [lindex $argv 1]
set timeout -1
set openidinum 970accb6-f8a1-4190-825c-6492d5627223
set umaID 7a55c863-a86b-411b-b71a-0c6c37747a3f
spawn $env(SHELL)
match_max 100000
expect  "$"
send -- "ssh ${USERNAME}@${HOST}"
expect -exact "${HOST}"
send -- "\r"
expect -re "(.*)\n"

send -- "/opt/jans/jans-cli/config-cli.py --no-suggestion"
expect -exact "/opt/jans/jans-cli/config-cli.py --no-suggestion"
send -- "\r"
expect "Selection:"

#puts "OAuth - OpenID Connect - Clients"

#send -- "16\r"
#expect "OAuth - OpenID Connect - Clients"
#send -- "1\r"
#expect "Gets list of OpenID Connect clients"
#send -- "\r"
#expect "pattern:"
#send -- "\r"
#expect "startIndex"
#send -- "\r"
#expect "sortBy"
#send -- "\r"
#expect "sortOrder"
#send -- "\r"
#expect "backchannelTokenDeliveryMode"
#send -- "b\r"
#expect "OAuth - OpenID Connect - Clients"
#send -- "2\r"
#expect "displayName"
#send -- "myopenclient\r"
#expect "applicationType"
#send -- "web\r"
#expect "includeClaimsInIdToken"
#send -- "\r"
#expect "Populate optional fields?"
#send -- "n\r"
#expect "Continue?"
#send -- "y\r"
#expect "Selection:"
#send -- "b\r"
#expect "OAuth - OpenID Connect - Clients"
#send -- "3\r"
#expect "Get OpenId Connect Client by Inum"
#send -- "$openidinum\r"
#expect "clientName"
#send -- "18\r"
#expect "contacts"
#send -- "manojsurya78@gmail.com\r"
#expect "Selection:"
#send -- "s\r"
#expect "Continue?"
#send -- "y\r"
#expect "manojsurya78@gmail.com"
#send -- "b\r"
#expect "OAuth - OpenID Connect - Clients"

#send -- "4\r"
#expect "Get OpenId Connect Client by Inum"
#send -- "$openidinum\r"
#expect "$openidinum"
#send -- "b\r"
#expect "OAuth - OpenID Connect - Clients"
#send -- "6\r"
#expect "inum:"
#send -- "$openidinum\r"
#expect "op:"
#send -- "replace\r"
#expect "path:"

#send -- "clientName\r"
#expect "value"
#send -- "myopenidclient1\r"
#expect "Another patch operation?"
#send -- "n\r"
#expect "Continue?"
#send -- "y\r"
#expect "myopenidclient1"  timeout {
#    puts "unable to save client name"
#   exit 1
 
#} 
#send -- "b\r"
#expect "OAuth - OpenID Connect - Clients"
##send -- "5\r"
##expect "inum:"
##send -- "$openidinum\r"
##expect "Are you sure want to delete"
##send -- "y\r"
##expect "Selection:"
##send -- "b\r"
##expect "OAuth - OpenID Connect - Clients"
#send -- "b\r"
#expect "Attribute"

#send -- "17\r"
#expect "OAuth - UMA Resources"
#send  -- "2\r"
#expect "id:"
#send -- "manojUMA\r"
#expect "iconUri"
#send -- "http://google.com\r"
#expect "type"
#send -- "WEB\r"
#expect "Populate optional fields?"
#send -- "y\r"
#expect "Selection:"
#send -- "8\r"
#expect "description"
#send -- "umadesc\r"
#expect "Selection:"
#send -- "#\r"
#expect "Selection:"
#send -- "1\r"
#expect "name"
#send -- "UMAresource\r"
#expect "Selection:"
#send -- "c\r"
#expect "Continue?"
#send -- "y\r"
#expect "UMAresource"
#send -- "b\r"
#expect "OAuth - UMA Resources"
#send  -- "1\r"
#expect "limit"
#send  -- "\r"
#expect "pattern"

#send  -- "\r"
#expect "UMAresource"
#send -- "b\r"
#expect "OAuth - UMA Resources"
#send  -- "3\r"
#expect "id:"
#send -- "$umaID\r"
#expect "Fields"
#send -- "10\r"
#expect "name"
#send -- "UMAresourceId\r"
#expect "Selection:"
#send -- "s\r"
#expect "Continue?"
#send -- "y\r"
#expect "UMAresourceId"

#send -- "b\r"
#expect "OAuth - UMA Resources"

#send  -- "4\r"
#expect "id:"
#send -- "$umaID\r"
#expect "$umaID"

#send -- "b\r"
#expect "OAuth - UMA Resources"

#send  -- "6\r"
#expect "id:"
#send -- "$umaID\r"

#expect "op:"
#send -- "replace\r"
#expect "path:"
#send -- "name\r"
#expect "value"
#send -- "UMAResource\r"
#expect "Another patch operation?"
#send -- "n\r"

#expect "Continue?"
#send -- "y\r"
#expect "UMAResource"
#send -- "b\r"
#expect "OAuth - UMA Resources"
#send -- "b\r"
#expect "Attribute


puts "OAuth - Scopes"

send -- "18\r"
expect "OAuth - Scopes"
send  -- "1\r"
expect "type:"
send -- "\r"
expect "limit"
send -- "\r"
expect "pattern"
send -- "\r"
expect "C4F6"
send -- "b\r"
expect "OAuth - Scopes"
send  -- "2\r"
expect "id:"
send -- "testscope\r"
expect "scopeType"
send  -- "openid\r"
expect "Populate optional fields?"
send -- "n\r"
expect "Continue?"
send -- "y\r"
expect "testscope"
send -- "b\r"
expect "OAuth - Scopes"
send  -- "3\r"
expect "inum"
send -- "C4F6\r"
expect "expirationDate"
send -- "4\r"
expect "deletable"
send -- "_true\r"
expect "Selection:"
send -- "s\r"
expect "Continue?"
send -- "y\r"
expect "deletable"
send -- "b\r"
expect "OAuth - Scopes"
send  -- "4\r"
expect "inum"
send -- "C4F6\r"
expect "C4F6"
send -- "b\r"
expect "OAuth - Scopes"
send -- "b\r"
expect "OAuth - Scopes"
send -- "b\r"
expect "Attribute"

puts "Statistics - User testing started"

send -- "19\r"
expect "Provides server with basic statistic"
send -- "1\r"
expect "month:"
send -- "202204"
expect "format"
send -- "\r"
expect "monthly_active_users"
send -- "b\r"
expect "Provides server with basic statistic"
send -- "b\r"
expect "Attribute"

puts "Health - Check"

send -- "20\r"
expect "Health - Check"
send -- "1\r"
expect "\"status\": \"UP\""
send -- "b\r"
expect "Health - Check"
send -- "2\r"
expect "\"status\": \"UP\""
send -- "b\r"
expect "Health - Check"
send -- "3\r"
expect "\"status\": \"UP\""
send -- "b\r"
expect "Health - Check"
send -- "b\r"
expect "Attribute"


puts "Server Stats"

send -- "21\r"
expect "Server Stats"
send -- "1\r"
expect "\"dbType\": \"ldap\""
send -- "b\r"
expect "Server Stats"
send -- "b\r"
expect "Attribute"


puts " SCIM - User Management"

send -- "22\r"
expect "SCIM - User Management"
send -- "1\r"
expect "filter:"
send -- "\r"
expect "startIndex"
send -- "\r"
expect "count"
send -- "\r"
expect "sortBy"
send -- "\r"
expect "sortOrder"
send -- "\r"
expect "attributes"
send -- "\r"
expect "excludedAttributes"
send -- "\r"
expect "schemas"
send -- "b\r"
expect "SCIM - User Management"
send -- "2\r"
expect "schemas"
send -- "urn:ietf:params:scim:schemas:core:2.0:User"
expect "id"
send -- "\r"
expect "resourceType"
send -- "user\r"
expect "created"
send -- "\r"
expect "lastModified"
send -- "\r"
expect "location"
send -- "\r"
expect "externalId"
send -- "\r"
expect "userName"
send -- "manojadmin\r"
expect "familyName"
send -- "manojadmin\r"
expect "givenName"
send -- "manojadmin\r"
expect "middleName"
send -- "manojadmin\r"
expect "honorificPrefix"
send -- "\r"
expect "honorificSuffix"
send -- "\r"
expect "formatted"
send -- "manojadmin manojadmin\r"
expect "displayName"
send -- "manojadmin\r"
expect "nickName"
send -- "manojadmin\r"
expect "profileUrl"
send -- "\r"
expect "title"
send -- "\r"
expect "userType"
send -- "\r"
expect "preferredLanguage"
send -- "\r"
expect "locale"
send -- "\r"
expect "timezone"
send -- "\r"
expect "active"
send -- "_true\r"
expect "password"
send -- "\r"

expect "Add Email?"
send -- "y\r"
expect "value"
send -- "manojsu@gmail.com\r"
expect "display"
send -- "\r"
expect "type"
send -- "\r"
expect "primary"
send -- "\r"
expect "Add another Email?"
send -- "n\r"
expect "Add PhoneNumber?"
send -- "n\r"
expect "Add InstantMessagingAddress?"
send -- "n\r"
expect "Add Photo?"
send -- "n\r"
expect "Add Address?"
send -- "n\r"
expect "Add Group?"
send -- "n\r"
expect "Add Entitlement?"
send -- "n\r"
expect "Add Role?"
send -- "n\r"
expect "Add X509Certificate?"
send -- "n\r"
expect "Populate optional fields?"
send -- "n\r"
expect "Continue?"
send -- "y\r"
expect "urn:ietf:params:scim:schemas:core:2.0:User"

send -- "b\r"
expect "SCIM - User Management"
send -- "b\r"
expect "Attribute"



expect eof
